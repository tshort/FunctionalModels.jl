<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Design Documentation · FunctionalModels.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FunctionalModels.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../basics/">Basics</a></li><li><a class="tocitem" href="../sims/">API</a></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../lib/types/">The FunctionalModels standard library</a></li><li><a class="tocitem" href="../lib/blocks/">Control and signal blocks</a></li><li><a class="tocitem" href="../lib/electrical/">Analog electrical models</a></li><li><a class="tocitem" href="../lib/heat_transfer/">Heat transfer models</a></li><li><a class="tocitem" href="../lib/rotational/">Rotational mechanics</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/basics/">Examples using basic models</a></li><li><a class="tocitem" href="../examples/lib/">FunctionalModels.Lib</a></li><li><a class="tocitem" href="../examples/tiller/">Tiller examples</a></li></ul></li><li><a class="tocitem" href="../NEWS/">Release notes</a></li><li><a class="tocitem" href="../LICENSE/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Design Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Design Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tshort/FunctionalModels.jl/blob/master/docs/src/design.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Design-Documentation"><a class="docs-heading-anchor" href="#Design-Documentation">Design Documentation</a><a id="Design-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Design-Documentation" title="Permalink"></a></h1><p>This documentation is an overview of the design of FunctionalModels, particularly the input specification. Some of the internals are also discussed.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>This implementation follows the work of David Broman and his MKL and Modelyze simulators and the work of George Giorgidze and Henrik Nilsson and their functional hybrid modeling.</p><p>A nodal formulation is used based on David&#39;s work. His thesis documents this nicely:</p><ul><li>David Broman. Meta-Languages and Semantics for Equation-Based Modeling and Simulation. PhD thesis, Thesis No 1333. Department of Computer and Information Science, Linköping University, Sweden, 2010. http://www.bromans.com/david/publ/thesis-2010-david-broman.pdf</li></ul><p>Here is David&#39;s code and home page:</p><ul><li>http://web.ict.kth.se/~dbro/</li><li>http://www.eecs.berkeley.edu/Pubs/TechRpts/2012/EECS-2012-173.pdf</li><li>http://www.bromans.com/software/mkl/mkl-source-1.0.0.zip</li><li>https://github.com/david-broman/modelyze</li></ul><p>FunctionalModels implements something like David&#39;s approach in MKL and Modelyze. Modelyze models in particular look quite similar to FunctionalModels models. A model constructor returns a list of equations. Models are made of models, so this builds up a hierarchical structure of equations that then needs to be flattened. Like David&#39;s approach, FunctionalModels is nodal; nodes are passed in as parameters to models to perform connections between devices. </p><p>Modeling of dynamically varying systems is handled similarly to functional hybrid modelling (FHM), specifically the Hydra implementation by George. See here for links:</p><ul><li>https://github.com/giorgidze/Hydra</li><li>http://www.cs.nott.ac.uk/~nhn/</li></ul><p>FHM is also a functional approach. Hydra is implemented as a domain specific language embedded in Haskell. Their implementation handles dynamically changing systems with JIT-compiled code from an amazingly small amount of code.</p><p>Models can have positional function arguments and/or keyword function arguments. Arguments may also have defaults. By convention in the standard library, all models are defined with positional  arguments for arguments that are normally nodes and keyword arguments for all other model parameters.</p><p>As with most functional approaches, arguments to models can be model types. This &quot;functional composition&quot; allows for easier replacement of internal model subcomponents. For example, the <code>BranchHeatPort</code> in the standard electrical library has the following signature:</p><pre><code class="language-julia hljs">function BranchHeatPort(n1::ElectricalNode, n2::ElectricalNode, hp::HeatPort,
                        model::Function; args...)</code></pre><p>This can be used to add heat ports to any electrical branch passed in with <code>model</code>. Here&#39;s an example of a definition defining a Resistor that uses a heat port (a Temperature) in terms of another model:</p><pre><code class="language-julia hljs">function Resistor(n1::ElectricalNode, n2::ElectricalNode; R::Signal, hp::Temperature, T_ref::Signal, alpha::Signal) 
    BranchHeatPort(n1, n2, hp, Resistor, R = R .* (1 + alpha .* (hp - T_ref)))
end</code></pre><p>By convention in the standard library, the first model arguments are generally nodes.</p><h2 id="Special-Model-Features"><a class="docs-heading-anchor" href="#Special-Model-Features">Special Model Features</a><a id="Special-Model-Features-1"></a><a class="docs-heading-anchor-permalink" href="#Special-Model-Features" title="Permalink"></a></h2><p>The following are special model types, functions, or models that are handled specially when flattening or during instantiation:</p><ul><li><code>der(x)</code> or <code>D(x)</code> – The time derivative of <code>x</code>.</li><li><code>t</code> – The model time, secs.</li><li><code>RefBranch(node, flowvariable)</code> – The type RefBranch is used to indicate the potential <code>node</code> and the flow (<code>flowvariable</code>) into the node from a branch connected to it.</li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Friday 24 December 2021 21:15">Friday 24 December 2021</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
